# 1.前言

bilibili-chatbot-plus 是作者于 2024 年编写的第一版 B 站 AI 聊天助手的升级版，使用 DDD 架构以及常见的设计模式对原代码进行重构，并对其中一些功能进行优化以及增加新功能。对于通义千问大模型的调用，作者使用了自己开发的 SDK，有需要可移步至 GitHub 仓库：https://github.com/zm0071357/qwen-sdk

bilibili-chatbot-plus 体验地址：https://message.bilibili.com/?spm_id_from=333.788.0.0#/whisper/mid3546816612141631

# 2.功能

## 2.1 多轮聊天

与第一版 B 站 AI 聊天助手一样，升级版同样支持多轮聊天，与上一版不同的是，升级版新增了定时任务，控制聊天记录的数量，防止请求的 token 超出限制导致请求失败

## 2.2 多模态

对比第一版 B 站 AI 聊天助手，在识别图片和视频总结的基础上进一步优化，图片识别和视频总结的效果提高，并且视频总结相较之前只能总结三分钟内视频，现在支持总结十分钟左右的视频，由于视频总结所需 token 较多，所以不会计入聊天记录

## 2.3 图像生成

对比第一版 B 站 AI 聊天助手，升级版使用了新的模型，生成的效果比第一版会好很多，在图像编辑的能力上保留了扩图、指令编辑功能，新增了去文字水印、图像超分、图像上色等功能

## 2.4 视频生成

这是本次升级版新加入的功能，分为文生视频和图生视频两种功能，其中图生视频需要提前发送一张图片给 AI 助手，AI 助手会根据聊天记录的最后一张图片作为视频首帧进行创作，创作完成会把下载链接发送给用户，可按需下载，同时会投稿视频至 B 站，方便用户点击查看，同样的，视频生成后的内容也不会计入聊天记录

# 3.后续计划

## 3.1 登录问题

由于 B 站的操作需要使用 Cookie，而 Cookie 比较容易失效，导致获取对话列表或者发送消息失败，所以后续考虑使用 Redis 的监听机制和 Java 的反射机制动态设置 Cookie，避免每次 Cookie 更新都要重新部署

## 3.2 聊天记录保存

每次重启聊天记录都会消失，后续考虑使用 Redis 缓存来保存聊天记录

## 3.2 其他

修复一些未发现的 bug